#!/bin/bash 
ssh -i ~/.ec2/obawmata_dev.pem ubuntu@$1 -n "\
curl -L https://omnitruck.chef.io/install.sh | sudo bash && \
echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDhQInDiVu/Q8EnbdShXTkU8qjUhPD18YHSKCRCohO2KJO89TQKKWiG2lL2SSoxL+Ago5sntdFKefSIzIYTGE2p6zfWB21F8m/6+mcPqZvyF2sshbxOYi3l1DrWCnNPSq+nEWWvZr0rJdwP1jLgm4AUMNEz+y0XxMLUq7iftTIYzuW5//jqAya3OSKxQA2xkDT++FGrq3gu4jneS2eIcDOojoB3dYzq2CxMJve0QwFUt2RYlWXRdDHvGevZMosNhu4X653xz5owMzXJtLq2y/wBekrIURDOotbUcEykStYBRXTpUjCavQuikVSha4ydeRZSFndHy5pdYhK5mEEwyP3zXlCsnXE1YdZonNWTrDKGVAepYV/BnCX/yniWJVn8pVM55pSggZS8j18Cq9LVm/qOy125TyNBUvmkhGdZmcN2DEyMzkMELe0DYE2nGRizOBiwIkdR3B6jCIcscP0cwY/guGzyxSLkKy9UXK5VL2cpddSU+nZp09shpFxT4JWZ/1/ZZxWn0O26BaB6uJhqdNgEphFslNbTvKaFQVLECoCyRYsu3ov9nZaPPWp2r6SYRTvbPOLg2b9U9wK2CCtWIWx+6cskcVvi8khLI1mRXLCW0GQTYUyDw1QkdeD8Xh0RiiaIP32TQ9CmoE2sdnGeJnk6nMfjkP/VYHOwNg2mSFegzw== sheldonb@gmail.com'>.ssh/id_rsa.pub && \
echo '-----BEGIN RSA PRIVATE KEY-----
MIIJKgIBAAKCAgEA4UCJw4lbv0PBJ23UoV05FPKo1ITw9fGB0igkQqITtiiTvPU0
CilohtpS9kkqMS/gIKObJ7XRSnn0iMyGExhNqes31gdtRfJv+vpnD6mb8hdrLIW8
TmIt5dQ61gpzT0qvpxFlr2a9KyXcD9Yy4JuAFDDRM/stF8TC1Ku4n7UyGM7luf/4
6gMmtzkisUANsZA0/vhRq6t4LuI53ktniHAzqI6Ad3WM6tgsTCb3tEMBVLdkWJVl
0XQx7xnr2TKLDYbuF+ud8c+aMDM1ybS6tsv8AXpKyFEQzqLW1HBMpErWAUV06VIw
mr0LopFUoWuMnXkWUhZ3R8uaXWISuZhBMMj9815QrJ1xNWHWaJzVk6wyhlQHqWFf
wZwl/8p4liVZ/KVTOeaUoIGUvI9fAqvS1Zv6jstduU8jQVL5pIRnWZnDdgxMjM5D
BC3tA2BNpxkYszgYsCJHUdweowiHLHD9HMGP4Lhs8sUi5CsvVFyuVS9nKXXUlPp2
adPbIaRcU+CVmf9f2WcVp9DtugWgeriYanTYBKYRbJTW07ymhUFSxAqAskWLLt6L
/Z2Wjz1qdq+kmEU72zzi4Nm/VPcCtggrViFsfunLJHFb4vJISyNZkVywltBkE2FM
g8NUJHXg/F4dEYomiD99k0PQpqBNrHZxniZ5OpzH45D/1WBzsDYNpkhXoM8CAwEA
AQKCAgEA4Q5ilwP+rzM7IfISqMdD6TIqjWvmdVU/qIKC+DCIEVCpi/pSbHTDAznP
+lNP3KVBAlt1AlAfNJJ1SNlQfHOj5UonF6mD/Icma1UU9Ak6zr+nTWyxoH9n7GII
ByOZ4nd02TAAsSetihbhsNELNG8poQLFg3JKs5zcLTEF3kxkKXVPAnBGe0l6vUZQ
61hcVjUHPllNAIDqK63Ms9YTM7cnZho7MSA6E8q5N70XcPwhsEsr73YVrRiza3oy
s2hUlsdhzHSV8qzCGbaQ31+7zjgxKijN3ydf65W3n7o0WVKMT+jdzuFXvsNzhJJA
RKf4br41Fv9rXkiHixYaL2V4fQ3U7BwMuOMA67MpfrbSfr+BoZP6IOKh1rFwb7/g
IUD1prLwciJwbYhI7sazFhLJE9B0w6I3L4gptFKk1mdqagr65kG+Pume1OVzI+oB
F38qj5u2jlMB+ubZRvc/rNC4zL8LrFyd37L4pXKpiQWbaU6hINOwFmEYjHkVvM6Y
m5+9chsPYzArbpQL8VqHrfIbo4KIM98BtKbCM4LIEkuzUCj6hrKLlJfb1KYanBr6
KrFDhv0kIHagGx5U3PQB0g6fj1hL8SW3z5Ce8OQhzGvQ7vReDl2lJHcZgu+vH5Db
Nq9mL6KKQIWqUo0MaaxWj8yO8NBrA1WMe6B6rFu07szHArP594ECggEBAPf6OAWJ
mvB+1Z6PS994UgJ7Im4UBDx7+e4hw1F4qKJsa+5kJXpFAtsIGsbveW5r+UUnhxfG
kXEhqG8eoSVZZ8HfF+oa14bj1ZKsxZvaznpDFD7h2vMbUnoPslqp74pIPz4cg68s
KX7vZDi4R+/9jjPo9gxIUWM8fV0nr/BOilXbYl2TdQTgrnneYxmbmRm6tmYk1OIb
4O8NHA+LRtKntq4/uKYgxMk//L9qmB0HjUH2C6yevHYdwi5Tqx05E8MWRQ1X4q1J
q0OSLVmB2LmVFq51tdlJldll3dlrz3QQojjy166AJn+CRWTR2O/Frg7Dnuq9D/im
FmeMkdgjlUpRMzcCggEBAOiKGvSSEQczKSbN7+d/rm6nL+t/T1RQaRG6n4eRuvDT
tLfH1CoY3qTJpDg2b8BOG1SAgLkv2ZaeXm6LbZakmdxQ3ftHfPxTzMNBmyWYqdKs
AL/lZPxDWL+7nO2MpFF88buUeaduNGORDjNk/porBhx6hB8h4DKu4fBcOmDWnTf6
Iod3IaDREQZ758q8zbwm0e2E/WCCHBmmdvkFduotTlxUSQMXIe1ky2TcGRP7H1cN
BYlSDbA6WOsnz0V0cOCnci8cYXqTonsAHWwl3vYwqgdlDWI8sINNxD/2KZa1VTrE
5USZ3sXfwk/4EpFXiEGi89zEWwECVwPINRktODOdeykCggEBAJAZ89wj7sm6quCN
XQXroZyXeZaGQz/yu3ZKYHpDp5tbbg0GXVEEMXie6RCZsPMeA6jQI40JcxNO/9Yy
8moF3mmm/vqnxn84fq/RfrPnHv2lZWp1TQrg4bjUzkwpXG37NeUeJNfyzdpZut/L
FuK7cZtw0SqqC8GjMSalHXSD75ec+ThvrBy9hCaFuQj0hq+Q9NW+qYcLtFa2Q4w0
318i3uG7Xc4MVM6uRG3nv6V+8fNWy8nwJIxvFpxdOp6swHMpyc7LN4qDuOZ3V6sf
7ZVKsfeHp7kxLcc7jwP9xnwn/l0hoXxiM/z88t53o50SPueNfhfi7hkMSxC5ezci
1mptbVkCggEAFJVM54MaYMHFjbrC1oH1xbOkyTqeof7wHfKf9lcO7gw/PdlBTWyg
IIP8tkETSTlgr+0j98BliTCBeVV8IM53FApQa9KbHJaqVEo1WnGV7qDs/A9pDe9E
JsyLinddgB0IJKtyzUAzAPExCZmR88GFK/YoRb0w5CuYsjbnr/SvO+o3Ljh8UIjQ
8fr7vHVT3KivAlA4QVei9x5F/6rdKMNT4VZQlCZzCVlXq5jT23HqB0GO0OXjckrn
3gDLFwHEkA4iTEs90aTJyAttj0oW30HVewwV0DFBCo5Spbq7Way5W5dcF+Nq1acF
wyBZPGY8GFs9LLhwubkkTKBnGtBm3iK9aQKCAQEA3ncXEi32+Usg4caPj2qJ7TVI
tVuwowhqEnitYgGyKF7cCvvqvY+XV3Kv0FtRiofvGV1EaSztJ4vnGlSpJ45HQcOP
9YV6nIRSBZ/p7i9d4hIyHsDr8OGUgoXK5vVyeSzFDv7KIv9nQI6g4KacIVy3kZhI
QVuCVaVhrKcXqj5SNUz3AKjBQ0Ygqv/OfuKZRzJ+5+XCNZpxLgcAlALy84Zval+e
KZyR467e/6vGPrErFZqTHKj4TPD47ANp84HdCtyVDPvxupqyKjz3MZmFfak41ecP
3RopzpjaHxd2c2A2jf75+HxlZ7RzupSQKWRWNTqrNriM332HfRE6r/YQ+Gzdlg==
-----END RSA PRIVATE KEY-----' >.ssh/id_rsa && \
chmod 600 .ssh/id_rsa* && \
sudo chmod 666 /etc/ssh/ssh_config && \
echo '    StrictHostKeyChecking no' >>/etc/ssh/ssh_config && \
sudo chmod 644 /etc/ssh/ssh_config && \
sudo apt-get install git -y && \
git clone git@github.com:camsys/wmata-devops.git && \
sudo chef-solo -l debug -L /tmp/chef.log -c wmata-devops/chef-repo/solo.rb -E dev -j wmata-devops/chef-repo/$2.json"
