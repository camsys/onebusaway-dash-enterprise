<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2011 Metropolitan Transportation Authority Licensed under the Apache License, Version 2.0 (the "License"); 
    you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 
    Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS 
    IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language 
    governing permissions and limitations under the License. -->
<beans xmlns="http://www.springframework.org/schema/beans" 
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context" 
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd">


    <!-- Transit Data Service -->

    <bean id="transitDataService" class="org.springframework.remoting.caucho.HessianProxyFactoryBean">
        <property name="serviceUrl" value="http://localhost:8080/onebusaway-transit-data-federation-webapp/remoting/transit-data-service" />
        <property name="serviceInterface" value="org.onebusaway.transit_data.services.TransitDataService" />
        </bean>

        <bean id="configurationServiceClient" class="org.onebusaway.util.impl.configuration.ConfigurationServiceClientFileImpl" >
        <constructor-arg type="java.lang.String" value="/var/lib/oba/config.json"/>
    </bean>

    <!-- Database Configuration -->

    <bean id="dataSource"
          class="org.springframework.jndi.JndiObjectFactoryBean">
      <property name="jndiName"
                value="java:comp/env/jdbc/appDB"/>
      <property name="lookupOnStartup"
                value="true"/>
      <property name="cache"
                value="true"/>
      <property name="proxyInterface"
                value="javax.sql.DataSource"/>
      <property name="resourceRef"
                value="true" />
    </bean>

    <alias name="dataSource" alias="mutableDataSource" />



    <!-- Other Stuff: -->
<!--
    <bean id="defaultServiceBounds" class="org.onebusaway.geospatial.model.CoordinateBounds">
    		<property name="minLat" value="38.598692" />
    		<property name="minLon" value="-77.449457" />
    		<property name="maxLat" value="39.19148899999999" />
    		<property name="maxLon" value="-76.488045" />
    </bean>
   -->
    <bean id="externalGeocoderImpl" class="org.onebusaway.geocoder.enterprise.impl.EnterpriseGoogleGeocoderImpl">
      <property name="resultBiasingBounds" ref="defaultServiceBounds" />
  		<property name="wktFilterPolygon" value="POLYGON ((-77.1679272971524 38.58876288161198, -77.1688772660965 38.58869645859843, -77.16982924584117 38.58872069859017, -77.17077460332945 38.58883538176607, -77.17170476555846 38.58903946811832, -77.17261129732404 38.58933110688369, -77.17348597771557 38.58970765332724, -77.17471297771557 38.59030665332724, -77.17563405527815 38.59081806347138, -77.17649621745002 38.591423538988, -77.1772898948845 38.59211635955772, -77.17800627836355 38.59288883539731, -77.38590727836355 38.84221683539731, -77.38657068759925 38.84310893348678, -77.45588368759925 38.94802893348678, -77.45639288952512 38.94889058635644, -77.45681340919985 38.94979882392021, -77.45872940919985 38.95454682392021, -77.45904967857827 38.95546741687403, -77.45927880188354 38.95641481666945, -77.45941460229795 38.95738002240339, -77.45945578963082 38.95835386400498, -77.4594019725762 38.9593270893571, -77.45925366243047 38.96029045219739, -77.45901226823473 38.96123479996366, -77.45868008338799 38.96215116074903, -77.45826026385843 38.96303082854087, -77.45775679819971 38.96386544593336, -77.45717446965708 38.9646470835283, -77.45651881072358 38.96536831526935, -77.4557960505778 38.9660222889944, -77.21928005057781 39.1599272889944, -77.21867440464716 39.16038647235837, -77.21616140464715 39.16214547235837, -77.21554254590858 39.16254550778628, -77.21489590901488 39.16289888465255, -77.20824190901489 39.16622288465255, -77.20732916576638 39.16662331933126, -77.20638109385416 39.16693090317167, -77.20540711188129 39.16714258048771, -77.20441689585384 39.16725624837498, -76.67358689585384 39.20150724837497, -76.67261728968181 39.20152269423187, -76.67165074640722 39.20144415251254, -76.67069635515851 39.20127236180343, -76.66976309078957 39.20100893758092, -76.66885972948243 39.20065635701977, -76.66799476621831 39.20021793569837, -76.66717633489294 39.19969779641992, -76.66641213182746 39.19910083044262, -76.66570934339417 39.19843265148353, -76.66507457843774 39.19769954292852, -76.66451380612723 39.19690839874501, -76.6640322998236 39.19606665865276, -76.66363458749032 39.19518223816267, -76.65962758749032 39.18497523816266, -76.65929663497198 39.18398232332805, -76.65907127296794 39.18296025610651, -76.65895397011485 39.18192023231887, -76.65894601135926 39.18087364448384, -76.65904748388212 39.17983195702337, -76.68524848388212 39.00583495702337, -76.68536333454954 39.00520847083159, -76.71310533454954 38.87704147083159, -76.71334825953639 38.87612962717605, -76.71367605304141 38.87524474140972, -76.71408579615718 38.87439469318728, -76.71457384023844 38.87358705194505, -76.71619684023844 38.87116705194505, -76.71673429423458 38.87043916329666, -76.71733534078196 38.86976283369481, -76.71921934078196 38.86782683369481, -76.71983337539487 38.86724698710722, -76.72049414729547 38.86672102031512, -77.00125714729546 38.66199102031512, -77.00157354176808 38.66176953835134, -77.06915454176809 38.61638053835134, -77.06996635803034 38.61588951939525, -77.07082105398993 38.61547764553647, -77.07171093614171 38.615148624238, -77.14646693614171 38.591474624238, -77.14738120043829 38.59123201826899, -77.1483142971524 38.59107688161198, -77.1679272971524 38.58876288161198))" />
    </bean>

   <bean id="serviceAreaServiceImpl" class="org.onebusaway.presentation.impl.ServiceAreaServiceImpl">
    <property name="calculateDefaultBoundsFromAgencyCoverage" value="true" />
   </bean>

    <bean class="org.onebusaway.container.spring.PropertyOverrideConfigurer">
        <property name="properties">
            <props>
                <prop key="cacheManager.cacheManagerName">org.onebusaway.v2webapp.cacheManager</prop>
            </props>
        </property>
    </bean>
    <bean class="org.onebusaway.container.spring.SystemPropertyOverrideConfigurer">
            <property name="properties">
                    <props>
                            <prop key="front-end.version">${git.commit.id}</prop>
                    </props>
            </property>
    </bean>
        <!--  look up these values from web.xml/context.xml as they change per environment -->
        <!--
    <jee:jndi-lookup id="xwikiUrlBean" jndi-name="java:comp/env/xwikiUrl" resource-ref="true" ></jee:jndi-lookup>
    <jee:jndi-lookup id="xwikiDocumentEditUrlBean" jndi-name="java:comp/env/wikiDocumentEditUrl" resource-ref="true" ></jee:jndi-lookup>
    <jee:jndi-lookup id="xwikiAttachmentUrlBean" jndi-name="java:comp/env/wikiAttachmentUrl" resource-ref="true" ></jee:jndi-lookup>

    <bean id="wikiDocumentService" class="org.onebusaway.wiki.xwiki.impl.XWikiDocumentServiceImpl" lazy-init="true">
        <property name="xwikiUrl" ref="xwikiUrlBean" />
    </bean>

    <bean id="wikiRenderingService" class="org.onebusaway.wiki.xwiki.impl.XWikiRenderingServiceImpl" lazy-init="true">
        <property name="wikiDocumentViewUrl" value="/wiki/%{documentName}" />
        <property name="wikiDocumentEditUrl" ref="xwikiDocumentEditUrlBean" />
        <property name="wikiAttachmentUrl" ref="xwikiAttachmentUrlBean" />
    </bean>
    -->
    <import resource="classpath:branded-sources.xml" />
</beans>