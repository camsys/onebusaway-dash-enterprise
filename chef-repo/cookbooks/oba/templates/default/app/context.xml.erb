<?xml version='1.0' encoding='utf-8'?>
<Context>
    <WatchedResource>WEB-INF/web.xml</WatchedResource>

    <!-- database configuration moved to server.xml -->

    <Resource name="jdbc/appDB"
      auth="Container"
      type="javax.sql.DataSource"
      maxActive="50"
      maxIdle="1"
      maxWait="30000"
      validationQuery="select 1"
      testWhileIdle="true"
      timeBetweenEvictionRunsMillis="10000"
      minEvictableIdleTimeMillis="60000"
      username="<%= node[:oba][:db_user] %>"
      password="<%= node[:oba][:db_password] %>"
      queriesBeforeRetryMaster="300"
      secondsBeforeRetryMaster="60"
      failOverReadOnly="false"
      driverClassName="com.mysql.jdbc.Driver"
      url="jdbc:mysql://<%= node[:oba][:db_master] %>/<%= node[:oba][:db_instance_name] %>?rewriteBatchedStatements=true&amp;cachePrepStmts=true" >
      <connection-property name="readOnly">false</connection-property>
     </Resource>

    <Resource name="jdbc/agencyMetadataDB"
      auth="Container"
      type="javax.sql.DataSource"
      maxActive="2"
      maxIdle="1"
      maxWait="30000"
      validationQuery="select 1"
      testWhileIdle="true"
      timeBetweenEvictionRunsMillis="10000"
      minEvictableIdleTimeMillis="60000"
      username="<%= node[:oba][:db_user] %>"
      password="<%= node[:oba][:db_password] %>"
      queriesBeforeRetryMaster="300"
      secondsBeforeRetryMaster="60"
      failOverReadOnly="false"
      driverClassName="com.mysql.jdbc.Driver"
      url="jdbc:mysql://<%= node[:oba][:db_master] %>/<%= node[:oba][:db_archive] %>" >
      <connection-property name="readOnly">false</connection-property>
    </Resource>

    <Environment name="xwikiUrl" value="http://xwiki.prod.wmata.obaweb.org:8080/xwiki" type="java.lang.String" override="true" />
    <Environment name="wikiDocumentEditUrl" value="http://xwiki.prod.wmata.obaweb.org:8080/xwiki/bin/edit/%{namespace}/%{documentName}" type="java.lang.String" override="true" />
    <Environment name="wikiAttachmentUrl" value="http://xwiki.prod.wmata.obaweb.org:8080/xwiki/bin/download/%{namespace}/%{documentName}/%{attachmentName}" type="java.lang.String" override="true" />
    <Parameter name="obanyc.resource" value="onebusaway-wmata" override="false" />

</Context>
