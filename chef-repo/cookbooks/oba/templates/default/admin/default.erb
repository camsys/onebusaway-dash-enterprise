<VirtualHost *:80>
    ServerAdmin ops@example.com
    JkMount /* ajp13_worker
    JkUnMount /robots.txt ajp13_worker
    JkUnMount /release.html ajp13_worker
        DocumentRoot /var/www/
        <Directory />
                Options FollowSymLinks
                AllowOverride None
        </Directory>
        <Directory /var/www/>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                Require all granted 
                # This directive allows us to have apache2's default start page
                # in /apache2-default/, but still have / go to the right place
                #RedirectMatch ^/$ /apache2-default/
        </Directory>

        ErrorLog /var/log/apache2/error.log 

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog /var/log/apache2/access.log combined
        ServerSignature On

        Alias /doc/ "/usr/share/doc/"
        <Directory "/usr/share/doc/">
            Options Indexes MultiViews FollowSymLinks
            AllowOverride None
            Require host 127.0.0.0/255.0.0.0 ::1/128
        </Directory>

	ProxyPass /transitime/ http://gtfsrt.<%= node[:oba][:env] %>.wmata.obaweb.org:8080/
	ProxyPassReverse /transitime/ http://gtfsrt.<%= node[:oba][:env] %>.wmata.obaweb.org:8080/
	<Location /transitime>
                Require all granted
    </Location>

    RewriteEngine on
    RewriteRule "^/web/(.+)" "/transitime/web/$1" [PT]
    RewriteRule "^/api/v1/(.+)" "/transitime/api/v1/$1" [PT]

</VirtualHost>
