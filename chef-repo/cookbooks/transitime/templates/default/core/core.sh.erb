#!/bin/bash
export AWS_ACCESS_KEY=AKIAJD2S6RVL5BB5VD6Q
export AWS_SECRET_KEY=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

cd /var/lib/oba/transitime/core
java \
  -classpath logback-core-1.1.2.jar:logback-classic-1.1.2.jar:slf4j-api-1.7.2.jar \
  -Xmx2g \
  -Dtransitime.core.agencyId=<%= node[:oba][:transitime][:agency]%> \
  -Dtransitime.db.dbName=<%= node[:oba][:transitime][:dbname]%> \
  -Dtransitime.modules.optionalModulesList="org.transitime.core.predAccuracy.PredictionAccuracyModule;org.transitime.core.schedBasedPreds.SchedBasedPredsModule;org.transitime.custom.aws.AvlSqsClientModule" \
  -Dtransitime.avl.feedTimeoutInMSecs=30000 \
  -Dtransitime.core.maxPredictionTimeForDbSecs=3600 \
  -Dtransitime.avl.queueSize=100000 \
  -Dtransitime.avl.shouldUseSqs=true \
  -Dtransitime.avl.sqsUrl=https://sqs.us-east-1.amazonaws.com/443046490497/obawmata_prod \
  -Dtransitime.avl.messageLogFrequency=10000 \
  -Dtransitime.avl.snsKey=AKIAJ34CZNNFNL5G2CUA \
  -Dtransitime.avl.snsSecret=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 \
  -Dtransitime.avl.snsArn=arn:aws:sns:us-east-1:443046490497:wmata_avl \
  -Dtransitime.hibernate.configFile=/var/lib/oba/transitime/core/mysql_hibernate.cfg.xml \
  -Dlogback.configuration=/var/lib/oba/transitime/core/logback.xml \
  -jar \
  core.jar